"use strict";function Auth(e,n){return n()}function dataservice(e){function n(n,t,o){function a(e){return e.data}return e({url:"/api",method:"GET",params:{uniqueId:n,pageId:t,sessionId:o}}).then(a)}return{getData:n}}function StorageBucket(e,n){return n.storage()}!function(){angular.module("app",["ui.router","firebase"]).config(function(){var e={appName:"Hackney Social",authDomain:"hackneysocial-71b7f.firebaseapp.com",databaseURL:"https://hackneysocial-71b7f.firebaseio.com",storageBucket:"hackneysocial-71b7f.appspot.com",apiKey:"AIzaSyDTzHwzw-achZtFPdRLmZjnFnKrwf0_Exw"};firebase.initializeApp(e)})}(),function(){angular.module("app").config(["$stateProvider","$urlRouterProvider",function(e,n){n.otherwise("/"),e.state("blog",{url:"/",templateUrl:"components/blog-section/blog-index/indexView.html",controller:"blogIndexController"}).state("login",{url:"/admin/login",controller:"adminLoginController",templateUrl:"components/admin-section/admin-login/loginView.html",resolve:{requireNoAuth:["$state","Auth",function(e,n){return n.$requireSignIn().then(function(n){e.go("admin.home")},function(e){})}]}}).state("admin",{url:"/admin/home",controller:"adminIndexController",templateUrl:"components/admin-section/admin-index/indexView.html",resolve:{requireAuth:["$state","Auth",function(e,n){return n.$requireSignIn().then(function(e){},function(n){localStorage.getItem("HSToken")?(localStorage.removeItem("HSToken"),setTimeout(function(){e.go("login")},500)):e.go("login")})}]}}).state("admin.addvenue",{url:"/addvenue",controller:"adminAddvenueController",templateUrl:"components/admin-section/admin-addVenue/addVenueView.html",resolve:{requireAuth:["$state","Auth",function(e,n){return n.$requireSignIn().then(function(e){},function(n){localStorage.getItem("HSToken")?(localStorage.removeItem("HSToken"),setTimeout(function(){e.go("login")},500)):e.go("login")})}]}}).state("admin.profile",{url:"/profile",controller:"adminProfileController",templateUrl:"components/admin-section/admin-profile/profileView.html",resolve:{requireAuth:["$state","Auth",function(e,n){return n.$requireSignIn().then(function(e){},function(n){localStorage.getItem("HSToken")?(localStorage.removeItem("HSToken"),setTimeout(function(){e.go("login")},500)):e.go("login")})}]}}).state("admin.dashboard",{url:"/dashboard",controller:"adminDashboardController",templateUrl:"components/admin-section/admin-dashboard/dashboardView.html",resolve:{requireAuth:["$state","Auth",function(e,n){return n.$requireSignIn().then(function(e){},function(n){localStorage.getItem("HSToken")?(localStorage.removeItem("HSToken"),setTimeout(function(){e.go("login")},500)):e.go("login")})}]}})}])}(),function(){function e(e,n,t,o,a){e.userDetails={uid:n.$getAuth().uid,FBtoken:n.$getAuth().refreshToken,HStoken:localStorage.HSToken},e.newVenue={venueId:"",venueName:"",description:"",addressLine1:"",addressLine2:"",postCode:"",rating:"",price:"",features:"",category:"",starCount:""},e.addNewVenue=function(){return o({url:"/api/add/venue",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:a,data:{venueId:e.newVenue.venueId,venueName:e.newVenue.venueName,description:e.newVenue.description,addressLine1:e.newVenue.addressLine1,addressLine2:e.newVenue.addressLine2,postCode:e.newVenue.postCode,rating:e.newVenue.rating,price:e.newVenue.price,features:e.newVenue.features,category:e.newVenue.category,starCount:e.newVenue.starCount,adminUid:e.userDetails.uid,token:e.userDetails.HStoken}}).then(function(n){console.log(n),e.addNewVenueResult=n},function(n){console.log(n),e.addNewVenueResult=n})}}e.$inject=["$scope","Auth","$state","$http","$httpParamSerializer"],angular.module("app").controller("adminAddvenueController",e),e.$injext=["$scope","Auth","$state","$http","$httpParamSerializer"]}(),function(){function e(e,n,t){e.userDetails={uid:n.$getAuth().uid,token:n.$getAuth().refreshToken}}e.$inject=["$scope","Auth","$state"],angular.module("app").controller("adminDashboardController",e),e.$injext=["$scope","Auth","$state"]}(),function(){function e(e,n,t,o){e.userDetails={uid:n.$getAuth().uid,FBtoken:n.$getAuth().refreshToken,HStoken:localStorage.HSToken},e.logout=function(){n.$signOut().then(function(){localStorage.removeItem("HSToken"),setTimeout(function(){t.go("login")},500)})},e.collapse=function(){angular.element(".navbar-collapse").collapse("hide")},angular.element(document).ready(function(){angular.element("a").click(function(){angular.element("a").removeClass("active"),angular.element(this).addClass("active")})})}e.$inject=["$scope","Auth","$state","StorageBucket"],angular.module("app").controller("adminIndexController",e),e.$injext=["$scope","Auth","$state","StorageBucket"]}(),function(){function e(e,n,t,o,a){e.user={email:"",password:""},e.login=function(){n.$signInWithEmailAndPassword(e.user.email,e.user.password).then(function(e){console.log("User logged in to Firebase");var t=n.$getAuth().uid;i(t)},function(n){console.log(n.message),e.err=n});var i=function(e){return o({url:"/api/authenticate",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:a,data:{uid:e}}).then(function(e){if(1==e.data.authenticated){console.log(e.data.token);var o=e.data.token;localStorage.setItem("HSToken",o),t.go("admin.profile")}else n.$signOut().then(function(){console.log("no token recieved")})},function(e){console.log(e)})}}}angular.module("app").controller("adminLoginController",e),e.$inject=["$scope","Auth","$state","$http","$httpParamSerializer"]}(),function(){function e(e,n,t,o,a,i,r){e.userDetails={uid:n.$getAuth().uid,FBtoken:n.$getAuth().refreshToken,HStoken:localStorage.HSToken,venueCount:"",venuesAdded:[]},e.newAdmin={uid:"",displayName:"",email:"",password:""},e.error={message:""},e.addNewAdmin=function(){return o({url:"/api/add/admin",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:a,data:{uid:e.newAdmin.uid,displayName:e.newAdmin.displayName,email:e.newAdmin.email,password:e.newAdmin.password,token:e.userDetails.HStoken}}).then(function(n){console.log(n),e.addNewAdminResult=n},function(n){console.log(n),e.addNewAdminResult=n})},function(){o({url:"/api/current-admin/venue-count",method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:a,params:{uid:e.userDetails.uid,token:e.userDetails.HStoken}}).then(function(n){console.log(n),e.userDetails.venueCount=n},function(n){console.log(n),e.error.message=n})}()}angular.module("app").controller("adminProfileController",e),e.$inject=["$scope","Auth","$state","$http","$httpParamSerializer","$interval","$location"]}(),function(){function e(){}angular.module("app").controller("blogIndexController",e),e.$injext=[]}(),function(){function e(e,n){return{restrict:"E",link:function(t,o){!function t(){o.text(n(new Date,"H:mm:ss")),e(t,1e3)}()}}}angular.module("app").directive("clock",e),e.$inject=["$timeout","dateFilter"]}(),function(){function e(e,n){return{restrict:"E",link:function(t,o){!function t(){o.text(n(new Date,"M/d/yy")),e(t,36e5)}()}}}angular.module("app").directive("date",e),e.$inject=["$timeout","dateFilter"]}(),angular.module("app").factory("Auth",Auth),Auth.$inject=["$http","$firebaseAuth"],angular.module("app").factory("dataservice",dataservice),dataservice.$inject=["$http"],angular.module("app").factory("StorageBucket",StorageBucket),StorageBucket.$inject=["$http","firebase"];