"use strict";function Auth(e,t){return t()}function dataservice(e){function t(t,n,o){function r(e){return e.data}return e({url:"/api",method:"GET",params:{uniqueId:t,pageId:n,sessionId:o}}).then(r)}return{getData:t}}!function(){angular.module("app",["ui.router","firebase"]).config(function(){var e={appName:"Hackney Social",authDomain:"hackneysocial-71b7f.firebaseapp.com",databaseURL:"https://hackneysocial-71b7f.firebaseio.com",storageBucket:"hackneysocial-71b7f.appspot.com",apiKey:"AIzaSyDTzHwzw-achZtFPdRLmZjnFnKrwf0_Exw"};firebase.initializeApp(e)})}(),angular.module("app").factory("Auth",Auth),Auth.$inject=["$http","$firebaseAuth"],angular.module("app").factory("dataservice",dataservice),dataservice.$inject=["$http"],function(){angular.module("app").config(["$stateProvider","$urlRouterProvider",function(e,t){t.otherwise("/"),e.state("welcome",{url:"/",templateUrl:"index/template.html",controller:"indexController"}).state("login",{url:"/admin/login",controller:"loginController",templateUrl:"login/template.html",resolve:{requireNoAuth:["$state","Auth",function(e,t){return t.$requireSignIn().then(function(t){e.go("admin.home")},function(e){})}]}}).state("admin",{url:"/admin/profile",controller:"profileController",templateUrl:"profile/template.html",resolve:{requireAuth:["$state","Auth",function(e,t){return t.$requireSignIn().then(function(e){},function(t){localStorage.getItem("HSToken")?(localStorage.removeItem("HSToken"),setTimeout(function(){e.go("login")},500)):e.go("login")})}]}}).state("admin.venue",{url:"/venue",controller:"venueController",templateUrl:"profileVenue/template.html",resolve:{requireAuth:["$state","Auth",function(e,t){return t.$requireSignIn().then(function(e){},function(t){localStorage.getItem("HSToken")?(localStorage.removeItem("HSToken"),setTimeout(function(){e.go("login")},500)):e.go("login")})}]}}).state("admin.home",{url:"/home",controller:"homeController",templateUrl:"profileHome/template.html",resolve:{requireAuth:["$state","Auth",function(e,t){return t.$requireSignIn().then(function(e){},function(t){localStorage.getItem("HSToken")?(localStorage.removeItem("HSToken"),setTimeout(function(){e.go("login")},500)):e.go("login")})}]}}).state("admin.dashboard",{url:"/dashboard",controller:"dashboardController",templateUrl:"profileDashboard/template.html",resolve:{requireAuth:["$state","Auth",function(e,t){return t.$requireSignIn().then(function(e){},function(t){localStorage.getItem("HSToken")?(localStorage.removeItem("HSToken"),setTimeout(function(){e.go("login")},500)):e.go("login")})}]}})}])}(),function(){function e(){}angular.module("app").controller("indexController",e),e.$injext=[]}(),function(){function e(e,t,n,o,r){e.user={email:"",password:""},e.login=function(){t.$signInWithEmailAndPassword(e.user.email,e.user.password).then(function(e){console.log("User logged in to Firebase");var n=t.$getAuth().uid;a(n)},function(t){console.log(t.message),e.err=t});var a=function(e){return o({url:"/api/authenticate",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:r,data:{uid:e}}).then(function(e){if(1==e.data.authenticated){console.log(e.data.token);var o=e.data.token;localStorage.setItem("HSToken",o),n.go("admin.home")}else t.$signOut().then(function(){console.log("no token recieved")})},function(e){console.log(e)})}}}angular.module("app").controller("loginController",e),e.$inject=["$scope","Auth","$state","$http","$httpParamSerializer"]}(),function(){function e(e,t,n){e.userDetails={uid:t.$getAuth().uid,token:t.$getAuth().refreshToken},e.logout=function(){t.$signOut().then(function(){localStorage.removeItem("HSToken"),setTimeout(function(){n.go("login")},500)})}}e.$inject=["$scope","Auth","$state"],angular.module("app").controller("profileController",e),e.$injext=["$scope","Auth","$state"]}(),function(){function e(e,t,n){e.userDetails={uid:t.$getAuth().uid,token:t.$getAuth().refreshToken}}e.$inject=["$scope","Auth","$state"],angular.module("app").controller("dashboardController",e),e.$injext=["$scope","Auth","$state"]}(),function(){function e(e,t,n,o,r,a,i){e.userDetails={uid:t.$getAuth().uid,FBtoken:t.$getAuth().refreshToken,HStoken:localStorage.HSToken,venueCount:"",venuesAdded:[]},e.newAdmin={uid:"",displayName:"",email:"",password:""},e.error={message:""},e.addNewAdmin=function(){return o({url:"/api/add/admin",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:r,data:{uid:e.newAdmin.uid,displayName:e.newAdmin.displayName,email:e.newAdmin.email,password:e.newAdmin.password,token:e.userDetails.HStoken}}).then(function(t){console.log(t),e.addNewAdminResult=t},function(t){console.log(t),e.addNewAdminResult=t})},function(){o({url:"/api/current-admin/venue-count",method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:r,params:{uid:e.userDetails.uid,token:e.userDetails.HStoken}}).then(function(t){console.log(t),e.userDetails.venueCount=t},function(t){console.log(t),e.error.message=t})}()}angular.module("app").controller("homeController",e),e.$inject=["$scope","Auth","$state","$http","$httpParamSerializer","$interval","$location"]}(),function(){function e(e,t,n,o,r){e.userDetails={uid:t.$getAuth().uid,FBtoken:t.$getAuth().refreshToken,HStoken:localStorage.HSToken},e.newVenue={venueId:"",venueName:"",description:"",addressLine1:"",addressLine2:"",postCode:"",rating:"",price:"",features:"",category:"",starCount:""},e.addNewVenue=function(){return o({url:"/api/add/venue",method:"POST",headers:{"Content-Type":"application/x-www-form-urlencoded"},transformRequest:r,data:{venueId:e.newVenue.venueId,venueName:e.newVenue.venueName,description:e.newVenue.description,addressLine1:e.newVenue.addressLine1,addressLine2:e.newVenue.addressLine2,postCode:e.newVenue.postCode,rating:e.newVenue.rating,price:e.newVenue.price,features:e.newVenue.features,category:e.newVenue.category,starCount:e.newVenue.starCount,adminUid:e.userDetails.uid,token:e.userDetails.HStoken}}).then(function(t){console.log(t),e.addNewVenueResult=t},function(t){console.log(t),e.addNewVenueResult=t})}}e.$inject=["$scope","Auth","$state","$http","$httpParamSerializer"],angular.module("app").controller("venueController",e),e.$injext=["$scope","Auth","$state","$http","$httpParamSerializer"]}(),function(){function e(e,t){return{restrict:"E",link:function(n,o){!function n(){o.text(t(new Date,"H:mm:ss")),e(n,1e3)}()}}}angular.module("app").directive("clock",e),e.$inject=["$timeout","dateFilter"]}(),function(){function e(e,t){return{restrict:"E",link:function(n,o){!function n(){o.text(t(new Date,"M/d/yy")),e(n,36e5)}()}}}angular.module("app").directive("date",e),e.$inject=["$timeout","dateFilter"]}();